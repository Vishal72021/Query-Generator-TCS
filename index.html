<!DOCTYPE html>
<html lang="en" data-theme="red">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CIBC Query Generator</title>

    <!-- Fonts: Inter for UI, Fira Code for code cells (professional) -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Fira+Code:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Core Styles -->
    <link rel="stylesheet" href="css/tokens.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/page.css" />
    <link rel="stylesheet" href="css/inputs.css" />
  </head>

  <body class="font-ui" data-page="main">
    <div class="app">
      <div class="main-wrap">
        <!-- NAVBAR -->
        <header class="navbar" role="banner" aria-label="Top navigation">
          <div class="nav-row container">
            <!-- Left -->
            <div class="nav-left">
              <div class="brand">CIBC</div>
              <div class="tag muted">ETL QA Agent</div>
            </div>

            <!-- Center nav -->
            <nav class="nav-center" aria-label="Primary">
              <a href="#" class="muted">Home</a>
              <a href="#" class="muted">Docs</a>
              <a href="#" class="muted">Contact</a>
            </nav>

            <!-- Right -->
            <div class="nav-right" aria-hidden="false">
              <!-- Sign control is managed by JS; we only keep the theme toggle here -->
              <button
                id="themeToggle"
                class="btn ghost"
                aria-pressed="false"
                title="Toggle theme"
              >
                ðŸŒ—
              </button>
            </div>
          </div>
        </header>

        <!-- MAIN GRID -->
        <main>
          <!-- INTRO SECTION (JIRA BLOCK) -->
          <section class="intro" aria-labelledby="introHeading">
            <div class="intro-grid container">
              <div>
                <h1 id="introHeading">Welcome to CIBC's query generator</h1>
                <p class="muted">
                  Write and run Python and SQL queries with ease.
                </p>
              </div>

              <div>
                <div class="input-row">
                  <div class="input-group jira-key-group" id="jiraKeyWrapper">
                    <span class="input-icon" aria-hidden="true">
                      <svg width="16" height="16" viewBox="0 0 24 24">
                        <path
                          fill="currentColor"
                          d="M12 2a5 5 0 0 0-5 5v1H5v2h2v6h2v-6h2v6h2v-6h2v6h2v-9h-2V7a5 5 0 0 0-5-5z"
                        />
                      </svg>
                    </span>

                    <input
                      id="jiraKey"
                      type="password"
                      placeholder=""
                      aria-label="Enter JIRA key to generate"
                    />
                    <label class="floating-label" for="jiraKey"
                      >Enter JIRA key to generate</label
                    >
                    <button
                      class="input-action"
                      type="button"
                      aria-label="Clear JIRA key"
                    >
                      âœ•
                    </button>
                  </div>

                  <button id="authenticateBtn" class="btn primary auth-action">
                    Authenticate
                  </button>
                </div>

                <!-- Error line below the row -->
                <div
                  id="jiraError"
                  class="input-error hidden"
                  role="status"
                  aria-live="polite"
                >
                  Invalid JIRA key. Please enter a valid alphanumeric ticket.
                </div>
              </div>
            </div>
          </section>

          <!-- LEFT SIDEBAR -->
          <aside class="sidebar" aria-labelledby="connectionHeading">
            <h3 id="connectionHeading">Connection</h3>

            <!-- API Key Input -->
            <div class="input-group" aria-label="API token input">
              <span class="input-icon" aria-hidden="true">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path
                    fill="currentColor"
                    d="M12 1a4 4 0 0 0-4 4v3H6v12h12V8h-2V5a4 4 0 0 0-4-4zM8 8V5a4 4 0 0 1 8 0v3H8z"
                  />
                </svg>
              </span>

              <input
                id="apiKey"
                type="password"
                placeholder=""
                aria-label="Paste API token"
              />
              <label class="floating-label" for="apiKey">Paste API token</label>
              <button
                class="input-action"
                type="button"
                aria-label="Clear API token"
              >
                âœ•
              </button>
            </div>

            <button id="connectBtn" class="btn primary mt-12">Connect</button>

            <div class="tips mt-12">
              <p><strong>Tips</strong></p>
              <p>
                Prefix with <code>// sql</code> or <code>// python</code> to
                hint execution.
              </p>
              <p>Notebook auto-saves to local storage.</p>
            </div>

            <div class="actions-inline mt-12">
              <button id="importBtn" class="btn ghost" data-action="process">
                Import
              </button>
              <button id="exportBtn" class="btn ghost" data-action="process">
                Export
              </button>
            </div>
          </aside>

          <!-- NOTEBOOK / QUERY EDITOR -->
          <section class="notebook" aria-labelledby="notebookHeading">
            <h3 id="notebookHeading">Query generator</h3>

            <div id="cells" class="cells" role="list">
              <!-- CELL 1 -->
              <article class="cell" tabindex="-1" role="listitem">
                <div
                  class="reorder-handle drag-handle"
                  title="Drag to reorder"
                  aria-hidden="true"
                >
                  â‰¡
                </div>

                <!-- Floating mini-toolbar (appears on hover/focus) -->
                <div
                  class="cell-toolbar"
                  role="toolbar"
                  aria-label="Cell actions"
                >
                  <button
                    class="tool"
                    data-action="clone"
                    title="Clone cell"
                    aria-label="Clone"
                  >
                    ðŸ“„
                  </button>
                  <button
                    class="tool"
                    data-action="run"
                    title="Run cell"
                    aria-label="Run"
                  >
                    â–¶
                  </button>
                  <button
                    class="tool"
                    data-action="edit"
                    title="Edit cell"
                    aria-label="Edit"
                  >
                    âœŽ
                  </button>
                  <button
                    class="tool"
                    data-action="up"
                    title="Move up"
                    aria-label="Move up"
                  >
                    â†‘
                  </button>
                  <button
                    class="tool"
                    data-action="down"
                    title="Move down"
                    aria-label="Move down"
                  >
                    â†“
                  </button>
                  <button
                    class="tool"
                    data-action="delete"
                    title="Delete"
                    aria-label="Delete"
                  >
                    ðŸ—‘
                  </button>
                  <button
                    class="tool"
                    data-action="ai-explain"
                    title="Explain (AI)"
                    aria-label="Explain"
                  >
                    ðŸ’¡
                  </button>
                  <button
                    class="tool"
                    data-action="ai-fix"
                    title="Fix (AI)"
                    aria-label="Fix"
                  >
                    ðŸ”§
                  </button>
                </div>

                <div class="content">
                  <!-- set class 'code-10' so CSS can size it for 10 lines -->
                  <div class="card">
                    <div
                      class="code code-10"
                      contenteditable="false"
                      spellcheck="false"
                      aria-label="Cell code"
                    >
                      # Example cell 1 print('Hello world')
                    </div>
                  </div>
                </div>
              </article>

              <!-- ADD-BETWEEN BUTTON (between cells) -->
              <div class="add-between" role="separator" aria-hidden="true">
                <button class="btn add-between-btn" title="Add cell">
                  ï¼‹ Add cell
                </button>
              </div>

              <!-- CELL 2 -->
              <article class="cell" tabindex="-1" role="listitem">
                <div
                  class="reorder-handle drag-handle"
                  title="Drag to reorder"
                  aria-hidden="true"
                >
                  â‰¡
                </div>

                <div
                  class="cell-toolbar"
                  role="toolbar"
                  aria-label="Cell actions"
                >
                  <button
                    class="tool"
                    data-action="clone"
                    title="Clone cell"
                    aria-label="Clone"
                  >
                    ðŸ“„
                  </button>
                  <button
                    class="tool"
                    data-action="run"
                    title="Run cell"
                    aria-label="Run"
                  >
                    â–¶
                  </button>
                  <button
                    class="tool"
                    data-action="edit"
                    title="Edit cell"
                    aria-label="Edit"
                  >
                    âœŽ
                  </button>
                  <button
                    class="tool"
                    data-action="up"
                    title="Move up"
                    aria-label="Move up"
                  >
                    â†‘
                  </button>
                  <button
                    class="tool"
                    data-action="down"
                    title="Move down"
                    aria-label="Move down"
                  >
                    â†“
                  </button>
                  <button
                    class="tool"
                    data-action="delete"
                    title="Delete"
                    aria-label="Delete"
                  >
                    ðŸ—‘
                  </button>
                  <button
                    class="tool"
                    data-action="ai-explain"
                    title="Explain (AI)"
                    aria-label="Explain"
                  >
                    ðŸ’¡
                  </button>
                  <button
                    class="tool"
                    data-action="ai-fix"
                    title="Fix (AI)"
                    aria-label="Fix"
                  >
                    ðŸ”§
                  </button>
                </div>

                <div class="content">
                  <div class="card">
                    <div
                      class="code code-10"
                      contenteditable="false"
                      spellcheck="false"
                      aria-label="Cell code"
                    >
                      # Example cell 2 for i in range(3): print(i)
                    </div>
                  </div>
                </div>
              </article>

              <!-- ADD-BETWEEN BUTTON (after last existing cell) -->
              <div class="add-between" role="separator" aria-hidden="true">
                <button class="btn add-between-btn" title="Add cell">
                  ï¼‹ Add cell
                </button>
              </div>
            </div>

            <!-- actions above bottom -->
            <div class="actions-inline mt-12">
              <button id="runAllBtn" class="btn primary" disabled>
                Run all cells
              </button>
              <button id="updateDeltaBtn" class="btn ghost" disabled>
                Update to Delta table
              </button>
            </div>

            <!-- Notebook bottom actions (updated: Upload to SharePoint next to Run as new notebook) -->
            <div class="bottom-actions" style="align-items: center; gap: 12px">
              <div style="flex: 1"></div>
              <!-- pushes buttons to the right -->

              <button id="runAsNewBtn" class="btn primary">
                Run as new notebook
              </button>

              <!-- Upload to SharePoint (demo redirect) -->
              <button
                id="uploadSharePointBtn"
                class="btn upload"
                title="Upload to SharePoint"
              >
                <span>Upload to SharePoint</span>
                <svg
                  style="width: 16px; height: 16px; margin-left: 8px"
                  viewBox="0 0 24 24"
                  fill="none"
                  aria-hidden="true"
                >
                  <path
                    d="M12 3v12"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M8 7l4-4 4 4"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 21h14"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
          </section>
        </main>
      </div>
    </div>

    <!-- SIGN IN MODAL -->
    <div
      id="signupModal"
      class="modal hidden"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-labelledby="signupTitle"
    >
      <div class="modal-backdrop" data-dismiss="modal"></div>
      <div class="modal-panel">
        <header class="modal-header">
          <h3 id="signupTitle">Sign in</h3>
          <button class="modal-close" aria-label="Close">âœ•</button>
        </header>

        <div class="modal-body">
          <p class="muted">
            Use demo credentials or continue with your account.
          </p>

          <div class="mt-8">
            <label class="modal-label">Username</label>
            <input
              id="modalUser"
              class="modal-input"
              type="text"
              placeholder="vishal-jira"
            />
          </div>

          <div class="mt-8">
            <label class="modal-label">API token</label>
            <input
              id="modalToken"
              class="modal-input"
              type="password"
              placeholder="vishal-token"
            />
          </div>

          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 14px;
            "
          >
            <button id="modalSignInBtn" class="btn primary">Sign in</button>
            <button class="btn ghost modal-close">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- JS (keep original order) -->
    <script type="module" src="js/runner.js"></script>
    <script type="module" src="js/dragdrop.js"></script>
    <script type="module" src="js/wiring.js"></script>
    <script type="module" src="js/import-export.js"></script>

    <!-- UI enhancements -->
    <script type="module" src="js/ui.js"></script>
    <script type="module" src="js/inputs.js"></script>
    <script type="module" src="js/auth-demo.js"></script>
  </body>
</html>
